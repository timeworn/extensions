"use strict";
var _Sources = (() => {
  var __create = Object.create;
  var __defProp = Object.defineProperty;
  var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
  var __getOwnPropNames = Object.getOwnPropertyNames;
  var __getProtoOf = Object.getPrototypeOf;
  var __hasOwnProp = Object.prototype.hasOwnProperty;
  var __commonJS = (cb, mod) => function __require() {
    return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;
  };
  var __export = (target, all) => {
    for (var name in all)
      __defProp(target, name, { get: all[name], enumerable: true });
  };
  var __copyProps = (to, from, except, desc) => {
    if (from && typeof from === "object" || typeof from === "function") {
      for (let key of __getOwnPropNames(from))
        if (!__hasOwnProp.call(to, key) && key !== except)
          __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
    }
    return to;
  };
  var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
    // If the importer is in node compatibility mode or this is not an ESM
    // file that has been converted to a CommonJS file using a Babel-
    // compatible transform (i.e. "__esModule" has not been set), then set
    // "default" to the CommonJS "module.exports" for node compatibility.
    isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
    mod
  ));
  var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

  // node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUIBinding.js
  var require_DUIBinding = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUIBinding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUIForm.js
  var require_DUIForm = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUIForm.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUIFormRow.js
  var require_DUIFormRow = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUIFormRow.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUISection.js
  var require_DUISection = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUISection.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIButton.js
  var require_DUIButton = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIButton.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIHeader.js
  var require_DUIHeader = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIHeader.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIInputField.js
  var require_DUIInputField = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIInputField.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUILabel.js
  var require_DUILabel = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUILabel.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUILink.js
  var require_DUILink = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUILink.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIMultilineLabel.js
  var require_DUIMultilineLabel = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIMultilineLabel.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUINavigationButton.js
  var require_DUINavigationButton = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUINavigationButton.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIOAuthButton.js
  var require_DUIOAuthButton = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIOAuthButton.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUISecureInputField.js
  var require_DUISecureInputField = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUISecureInputField.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUISelect.js
  var require_DUISelect = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUISelect.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIStepper.js
  var require_DUIStepper = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIStepper.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUISwitch.js
  var require_DUISwitch = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUISwitch.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/ChapterDetails.js
  var require_ChapterDetails = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/ChapterDetails.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/Chapter.js
  var require_Chapter = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/Chapter.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/Cookie.js
  var require_Cookie = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/Cookie.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/HomeSection.js
  var require_HomeSection = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/HomeSection.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/IconText.js
  var require_IconText = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/IconText.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/MangaInfo.js
  var require_MangaInfo = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/MangaInfo.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/MangaProgress.js
  var require_MangaProgress = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/MangaProgress.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/PartialSourceManga.js
  var require_PartialSourceManga = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/PartialSourceManga.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/MangaUpdates.js
  var require_MangaUpdates = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/MangaUpdates.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/PBCanvas.js
  var require_PBCanvas = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/PBCanvas.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/PBImage.js
  var require_PBImage = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/PBImage.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/PagedResults.js
  var require_PagedResults = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/PagedResults.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/RawData.js
  var require_RawData = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/RawData.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/Request.js
  var require_Request = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/Request.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SourceInterceptor.js
  var require_SourceInterceptor = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SourceInterceptor.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/RequestManager.js
  var require_RequestManager = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/RequestManager.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/Response.js
  var require_Response = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/Response.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SearchField.js
  var require_SearchField = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SearchField.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SearchRequest.js
  var require_SearchRequest = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SearchRequest.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SourceCookieStore.js
  var require_SourceCookieStore = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SourceCookieStore.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SourceManga.js
  var require_SourceManga = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SourceManga.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SecureStateManager.js
  var require_SecureStateManager = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SecureStateManager.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SourceStateManager.js
  var require_SourceStateManager = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SourceStateManager.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/Tag.js
  var require_Tag = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/Tag.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/TagSection.js
  var require_TagSection = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/TagSection.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/TrackedMangaChapterReadAction.js
  var require_TrackedMangaChapterReadAction = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/TrackedMangaChapterReadAction.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/TrackerActionQueue.js
  var require_TrackerActionQueue = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/TrackerActionQueue.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/_exports.js
  var require_exports = __commonJS({
    "node_modules/@paperback/types/lib/generated/_exports.js"(exports) {
      "use strict";
      var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        var desc = Object.getOwnPropertyDescriptor(m, k);
        if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
          desc = { enumerable: true, get: function() {
            return m[k];
          } };
        }
        Object.defineProperty(o, k2, desc);
      } : function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        o[k2] = m[k];
      });
      var __exportStar = exports && exports.__exportStar || function(m, exports2) {
        for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p)) __createBinding(exports2, m, p);
      };
      Object.defineProperty(exports, "__esModule", { value: true });
      __exportStar(require_DUIBinding(), exports);
      __exportStar(require_DUIForm(), exports);
      __exportStar(require_DUIFormRow(), exports);
      __exportStar(require_DUISection(), exports);
      __exportStar(require_DUIButton(), exports);
      __exportStar(require_DUIHeader(), exports);
      __exportStar(require_DUIInputField(), exports);
      __exportStar(require_DUILabel(), exports);
      __exportStar(require_DUILink(), exports);
      __exportStar(require_DUIMultilineLabel(), exports);
      __exportStar(require_DUINavigationButton(), exports);
      __exportStar(require_DUIOAuthButton(), exports);
      __exportStar(require_DUISecureInputField(), exports);
      __exportStar(require_DUISelect(), exports);
      __exportStar(require_DUIStepper(), exports);
      __exportStar(require_DUISwitch(), exports);
      __exportStar(require_ChapterDetails(), exports);
      __exportStar(require_Chapter(), exports);
      __exportStar(require_Cookie(), exports);
      __exportStar(require_HomeSection(), exports);
      __exportStar(require_IconText(), exports);
      __exportStar(require_MangaInfo(), exports);
      __exportStar(require_MangaProgress(), exports);
      __exportStar(require_PartialSourceManga(), exports);
      __exportStar(require_MangaUpdates(), exports);
      __exportStar(require_PBCanvas(), exports);
      __exportStar(require_PBImage(), exports);
      __exportStar(require_PagedResults(), exports);
      __exportStar(require_RawData(), exports);
      __exportStar(require_Request(), exports);
      __exportStar(require_SourceInterceptor(), exports);
      __exportStar(require_RequestManager(), exports);
      __exportStar(require_Response(), exports);
      __exportStar(require_SearchField(), exports);
      __exportStar(require_SearchRequest(), exports);
      __exportStar(require_SourceCookieStore(), exports);
      __exportStar(require_SourceManga(), exports);
      __exportStar(require_SecureStateManager(), exports);
      __exportStar(require_SourceStateManager(), exports);
      __exportStar(require_Tag(), exports);
      __exportStar(require_TagSection(), exports);
      __exportStar(require_TrackedMangaChapterReadAction(), exports);
      __exportStar(require_TrackerActionQueue(), exports);
    }
  });

  // node_modules/@paperback/types/lib/base/Source.js
  var require_Source = __commonJS({
    "node_modules/@paperback/types/lib/base/Source.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.urlEncodeObject = exports.convertTime = exports.Source = void 0;
      var Source = class {
        constructor(cheerio) {
          this.cheerio = cheerio;
        }
        /**
         * @deprecated use {@link Source.getSearchResults getSearchResults} instead
         */
        searchRequest(query, metadata) {
          return this.getSearchResults(query, metadata);
        }
        /**
         * @deprecated use {@link Source.getSearchTags} instead
         */
        async getTags() {
          return this.getSearchTags?.();
        }
      };
      exports.Source = Source;
      function convertTime(timeAgo) {
        let time;
        let trimmed = Number((/\d*/.exec(timeAgo) ?? [])[0]);
        trimmed = trimmed == 0 && timeAgo.includes("a") ? 1 : trimmed;
        if (timeAgo.includes("minutes")) {
          time = new Date(Date.now() - trimmed * 6e4);
        } else if (timeAgo.includes("hours")) {
          time = new Date(Date.now() - trimmed * 36e5);
        } else if (timeAgo.includes("days")) {
          time = new Date(Date.now() - trimmed * 864e5);
        } else if (timeAgo.includes("year") || timeAgo.includes("years")) {
          time = new Date(Date.now() - trimmed * 31556952e3);
        } else {
          time = new Date(Date.now());
        }
        return time;
      }
      exports.convertTime = convertTime;
      function urlEncodeObject(obj) {
        let ret = {};
        for (const entry of Object.entries(obj)) {
          ret[encodeURIComponent(entry[0])] = encodeURIComponent(entry[1]);
        }
        return ret;
      }
      exports.urlEncodeObject = urlEncodeObject;
    }
  });

  // node_modules/@paperback/types/lib/base/ByteArray.js
  var require_ByteArray = __commonJS({
    "node_modules/@paperback/types/lib/base/ByteArray.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/Badge.js
  var require_Badge = __commonJS({
    "node_modules/@paperback/types/lib/base/Badge.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.BadgeColor = void 0;
      var BadgeColor;
      (function(BadgeColor2) {
        BadgeColor2["BLUE"] = "default";
        BadgeColor2["GREEN"] = "success";
        BadgeColor2["GREY"] = "info";
        BadgeColor2["YELLOW"] = "warning";
        BadgeColor2["RED"] = "danger";
      })(BadgeColor = exports.BadgeColor || (exports.BadgeColor = {}));
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/ChapterProviding.js
  var require_ChapterProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/ChapterProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/CloudflareBypassRequestProviding.js
  var require_CloudflareBypassRequestProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/CloudflareBypassRequestProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/HomePageSectionsProviding.js
  var require_HomePageSectionsProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/HomePageSectionsProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/MangaProgressProviding.js
  var require_MangaProgressProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/MangaProgressProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/MangaProviding.js
  var require_MangaProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/MangaProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/RequestManagerProviding.js
  var require_RequestManagerProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/RequestManagerProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/SearchResultsProviding.js
  var require_SearchResultsProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/SearchResultsProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/index.js
  var require_interfaces = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/index.js"(exports) {
      "use strict";
      var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        var desc = Object.getOwnPropertyDescriptor(m, k);
        if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
          desc = { enumerable: true, get: function() {
            return m[k];
          } };
        }
        Object.defineProperty(o, k2, desc);
      } : function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        o[k2] = m[k];
      });
      var __exportStar = exports && exports.__exportStar || function(m, exports2) {
        for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p)) __createBinding(exports2, m, p);
      };
      Object.defineProperty(exports, "__esModule", { value: true });
      __exportStar(require_ChapterProviding(), exports);
      __exportStar(require_CloudflareBypassRequestProviding(), exports);
      __exportStar(require_HomePageSectionsProviding(), exports);
      __exportStar(require_MangaProgressProviding(), exports);
      __exportStar(require_MangaProviding(), exports);
      __exportStar(require_RequestManagerProviding(), exports);
      __exportStar(require_SearchResultsProviding(), exports);
    }
  });

  // node_modules/@paperback/types/lib/base/SourceInfo.js
  var require_SourceInfo = __commonJS({
    "node_modules/@paperback/types/lib/base/SourceInfo.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.ContentRating = exports.SourceIntents = void 0;
      var SourceIntents2;
      (function(SourceIntents3) {
        SourceIntents3[SourceIntents3["MANGA_CHAPTERS"] = 1] = "MANGA_CHAPTERS";
        SourceIntents3[SourceIntents3["MANGA_TRACKING"] = 2] = "MANGA_TRACKING";
        SourceIntents3[SourceIntents3["HOMEPAGE_SECTIONS"] = 4] = "HOMEPAGE_SECTIONS";
        SourceIntents3[SourceIntents3["COLLECTION_MANAGEMENT"] = 8] = "COLLECTION_MANAGEMENT";
        SourceIntents3[SourceIntents3["CLOUDFLARE_BYPASS_REQUIRED"] = 16] = "CLOUDFLARE_BYPASS_REQUIRED";
        SourceIntents3[SourceIntents3["SETTINGS_UI"] = 32] = "SETTINGS_UI";
      })(SourceIntents2 = exports.SourceIntents || (exports.SourceIntents = {}));
      var ContentRating2;
      (function(ContentRating3) {
        ContentRating3["EVERYONE"] = "EVERYONE";
        ContentRating3["MATURE"] = "MATURE";
        ContentRating3["ADULT"] = "ADULT";
      })(ContentRating2 = exports.ContentRating || (exports.ContentRating = {}));
    }
  });

  // node_modules/@paperback/types/lib/base/HomeSectionType.js
  var require_HomeSectionType = __commonJS({
    "node_modules/@paperback/types/lib/base/HomeSectionType.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.HomeSectionType = void 0;
      var HomeSectionType;
      (function(HomeSectionType2) {
        HomeSectionType2["singleRowNormal"] = "singleRowNormal";
        HomeSectionType2["singleRowLarge"] = "singleRowLarge";
        HomeSectionType2["doubleRow"] = "doubleRow";
        HomeSectionType2["featured"] = "featured";
      })(HomeSectionType = exports.HomeSectionType || (exports.HomeSectionType = {}));
    }
  });

  // node_modules/@paperback/types/lib/base/PaperbackExtensionBase.js
  var require_PaperbackExtensionBase = __commonJS({
    "node_modules/@paperback/types/lib/base/PaperbackExtensionBase.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/index.js
  var require_base = __commonJS({
    "node_modules/@paperback/types/lib/base/index.js"(exports) {
      "use strict";
      var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        var desc = Object.getOwnPropertyDescriptor(m, k);
        if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
          desc = { enumerable: true, get: function() {
            return m[k];
          } };
        }
        Object.defineProperty(o, k2, desc);
      } : function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        o[k2] = m[k];
      });
      var __exportStar = exports && exports.__exportStar || function(m, exports2) {
        for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p)) __createBinding(exports2, m, p);
      };
      Object.defineProperty(exports, "__esModule", { value: true });
      __exportStar(require_Source(), exports);
      __exportStar(require_ByteArray(), exports);
      __exportStar(require_Badge(), exports);
      __exportStar(require_interfaces(), exports);
      __exportStar(require_SourceInfo(), exports);
      __exportStar(require_HomeSectionType(), exports);
      __exportStar(require_PaperbackExtensionBase(), exports);
    }
  });

  // node_modules/@paperback/types/lib/compat/DyamicUI.js
  var require_DyamicUI = __commonJS({
    "node_modules/@paperback/types/lib/compat/DyamicUI.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/index.js
  var require_lib = __commonJS({
    "node_modules/@paperback/types/lib/index.js"(exports) {
      "use strict";
      var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        var desc = Object.getOwnPropertyDescriptor(m, k);
        if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
          desc = { enumerable: true, get: function() {
            return m[k];
          } };
        }
        Object.defineProperty(o, k2, desc);
      } : function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        o[k2] = m[k];
      });
      var __exportStar = exports && exports.__exportStar || function(m, exports2) {
        for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p)) __createBinding(exports2, m, p);
      };
      Object.defineProperty(exports, "__esModule", { value: true });
      __exportStar(require_exports(), exports);
      __exportStar(require_base(), exports);
      __exportStar(require_DyamicUI(), exports);
    }
  });

  // node_modules/querystring/decode.js
  var require_decode = __commonJS({
    "node_modules/querystring/decode.js"(exports, module) {
      "use strict";
      function hasOwnProperty(obj, prop) {
        return Object.prototype.hasOwnProperty.call(obj, prop);
      }
      module.exports = function(qs, sep, eq, options) {
        sep = sep || "&";
        eq = eq || "=";
        var obj = {};
        if (typeof qs !== "string" || qs.length === 0) {
          return obj;
        }
        var regexp = /\+/g;
        qs = qs.split(sep);
        var maxKeys = 1e3;
        if (options && typeof options.maxKeys === "number") {
          maxKeys = options.maxKeys;
        }
        var len = qs.length;
        if (maxKeys > 0 && len > maxKeys) {
          len = maxKeys;
        }
        for (var i = 0; i < len; ++i) {
          var x = qs[i].replace(regexp, "%20"), idx = x.indexOf(eq), kstr, vstr, k, v;
          if (idx >= 0) {
            kstr = x.substr(0, idx);
            vstr = x.substr(idx + 1);
          } else {
            kstr = x;
            vstr = "";
          }
          k = decodeURIComponent(kstr);
          v = decodeURIComponent(vstr);
          if (!hasOwnProperty(obj, k)) {
            obj[k] = v;
          } else if (Array.isArray(obj[k])) {
            obj[k].push(v);
          } else {
            obj[k] = [obj[k], v];
          }
        }
        return obj;
      };
    }
  });

  // node_modules/querystring/encode.js
  var require_encode = __commonJS({
    "node_modules/querystring/encode.js"(exports, module) {
      "use strict";
      var stringifyPrimitive = function(v) {
        switch (typeof v) {
          case "string":
            return v;
          case "boolean":
            return v ? "true" : "false";
          case "number":
            return isFinite(v) ? v : "";
          default:
            return "";
        }
      };
      module.exports = function(obj, sep, eq, name) {
        sep = sep || "&";
        eq = eq || "=";
        if (obj === null) {
          obj = void 0;
        }
        if (typeof obj === "object") {
          return Object.keys(obj).map(function(k) {
            var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;
            if (Array.isArray(obj[k])) {
              return obj[k].map(function(v) {
                return ks + encodeURIComponent(stringifyPrimitive(v));
              }).join(sep);
            } else {
              return ks + encodeURIComponent(stringifyPrimitive(obj[k]));
            }
          }).join(sep);
        }
        if (!name) return "";
        return encodeURIComponent(stringifyPrimitive(name)) + eq + encodeURIComponent(stringifyPrimitive(obj));
      };
    }
  });

  // node_modules/querystring/index.js
  var require_querystring = __commonJS({
    "node_modules/querystring/index.js"(exports) {
      "use strict";
      exports.decode = exports.parse = require_decode();
      exports.encode = exports.stringify = require_encode();
    }
  });

  // src/MyAnimeList/MyAnimeList.ts
  var MyAnimeList_exports = {};
  __export(MyAnimeList_exports, {
    MyAnimeList: () => MyAnimeList,
    MyAnimeListInfo: () => MyAnimeListInfo
  });
  var import_types = __toESM(require_lib());

  // src/MyAnimeList/models/mal-result.ts
  function MalResult(response) {
    if (response.status !== 200) {
      console.log(`[MAL-ERROR(${response.status})] ${JSON.stringify(response, null, 2)}`);
      throw new Error("Error while fetching data from MyAnimeList, check logs for more info");
    }
    const result = typeof response.data == "string" ? JSON.parse(response.data) : response.data;
    return result;
  }

  // src/MyAnimeList/MyAnimeList.ts
  var import_querystring = __toESM(require_querystring());

  // src/MyAnimeList/MALSettings.ts
  var getDefaultStatus = async (stateManager) => {
    return await stateManager.retrieve("defaultStatus") ?? ["NONE"];
  };
  var trackerSettings = (stateManager) => {
    return App.createDUINavigationButton({
      id: "tracker_settings",
      label: "Tracker Settings",
      form: App.createDUIForm({
        sections: () => {
          return Promise.resolve([
            App.createDUISection({
              id: "settings",
              isHidden: false,
              header: "Status Settings",
              rows: async () => [
                App.createDUISelect({
                  id: "defaultStatus",
                  label: "Default Status",
                  allowsMultiselect: false,
                  value: App.createDUIBinding({
                    get: () => getDefaultStatus(stateManager),
                    set: async (newValue) => await stateManager.store("defaultStatus", newValue)
                  }),
                  labelResolver: async (value) => {
                    switch (value) {
                      case "reading":
                        return "Reading";
                      case "plan_to_read":
                        return "Planned";
                      case "completed":
                        return "Completed";
                      case "dropped":
                        return "Dropped";
                      case "on_hold":
                        return "On-Hold";
                      default:
                        return "None";
                    }
                  },
                  options: [
                    "NONE",
                    "reading",
                    "plan_to_read",
                    "completed",
                    "dropped",
                    "on_hold"
                  ]
                })
              ]
            })
          ]);
        }
      })
    });
  };

  // src/MyAnimeList/MyAnimeList.ts
  var MYANIMELIST_API = "https://api.myanimelist.net/v2";
  var MyAnimeListInfo = {
    name: "MyAnimeList",
    author: "Netsky",
    contentRating: import_types.ContentRating.EVERYONE,
    icon: "icon.png",
    version: "1.0.1",
    description: "MyAnimeList Tracker",
    websiteBaseURL: "https://myanimelist.net",
    intents: import_types.SourceIntents.MANGA_TRACKING | import_types.SourceIntents.SETTINGS_UI
  };
  var MyAnimeList = class {
    constructor() {
      this.stateManager = App.createSourceStateManager();
      this.requestManager = App.createRequestManager({
        requestsPerSecond: 2.5,
        requestTimeout: 2e4,
        interceptor: {
          // Authorization injector
          interceptRequest: async (request) => {
            const tokenData = await this.tokenData.get();
            if (tokenData?.expires_in && tokenData.expires_in - 1296e3 < Date.now() / 1e3) {
              console.log("Access token has expired, refreshing the access token!");
              await this.tokenData.refresh();
            }
            request.headers = {
              ...request.headers ?? {},
              ...{
                "accept": "application/json"
              },
              ...tokenData != null ? {
                "authorization": `Bearer ${tokenData.access_token}`
              } : {}
            };
            return request;
          },
          interceptResponse: async (response) => {
            return response;
          }
        }
      });
      this.tokenData = {
        get: async () => {
          return this.stateManager.keychain.retrieve("token_data");
        },
        set: async (tokenData) => {
          await this.stateManager.keychain.store("token_data", tokenData);
          await this.userInfo.refresh();
        },
        isValid: async () => {
          return await this.tokenData.get() != null;
        },
        refresh: async () => {
          await this.refreshAccessToken();
        }
      };
      this.userInfo = {
        get: async () => {
          return this.stateManager.retrieve("userInfo");
        },
        isLoggedIn: async () => {
          return await this.userInfo.get() != null;
        },
        refresh: async () => {
          const tokenData = await this.tokenData.get();
          if (tokenData == null) {
            return this.stateManager.store("userInfo", void 0);
          }
          const response = await this.requestManager.schedule(App.createRequest({
            url: `${MYANIMELIST_API}/users/@me`,
            method: "GET"
          }), 0);
          const userInfo = MalResult(response);
          await this.stateManager.store("userInfo", userInfo);
        }
      };
    }
    async getSearchResults(query, metadata) {
      const pageURL = metadata;
      const response = await this.requestManager.schedule(App.createRequest({
        url: pageURL ?? `${MYANIMELIST_API}/manga?q=${encodeURI(query.title ?? "")}&nsfw=true`,
        method: "GET"
      }), 1);
      const malPage = MalResult(response);
      if (!malPage || malPage.data.length == 0) {
        return App.createPagedResults({ results: [], metadata: void 0 });
      }
      return App.createPagedResults({
        results: malPage.data?.map((manga) => App.createPartialSourceManga({
          image: manga.node.main_picture?.large ?? "",
          title: manga.node.title,
          mangaId: manga.node.id.toString(),
          subtitle: void 0
        })) ?? [],
        metadata: malPage.paging?.next
      });
    }
    async getMangaDetails(mangaId) {
      const response = await this.requestManager.schedule(App.createRequest({
        url: encodeURI(`${MYANIMELIST_API}/manga/${parseInt(mangaId)}?fields=id,title,main_picture,alternative_titles,synopsis,mean,rank,popularity,nsfw,media_type,status,my_list_status,num_volumes,num_chapters,authors{first_name,last_name}`),
        method: "GET"
      }), 1);
      const malManga = MalResult(response);
      if (malManga == null) {
        return Promise.reject();
      }
      return App.createSourceManga({
        id: mangaId,
        mangaInfo: App.createMangaInfo({
          image: malManga.main_picture?.large ?? "",
          titles: [
            malManga.title,
            malManga.alternative_titles?.en,
            malManga.alternative_titles?.ja
          ].filter((x) => x != null),
          artist: this.formatStaffName(malManga.authors?.find((x) => x?.role?.toLowerCase().includes("art"))?.node),
          author: this.formatStaffName(malManga.authors?.find((x) => x?.role?.toLowerCase().includes("story"))?.node),
          desc: malManga?.synopsis || "",
          hentai: this.formatNSFW(malManga?.nsfw ?? ""),
          rating: malManga.mean,
          // eslint-disable-next-line @typescript-eslint/ban-ts-comment
          // @ts-ignore
          status: this.formatStatus(malManga.status)
        })
      });
    }
    async getMangaProgress(mangaId) {
      const response = await this.requestManager.schedule(App.createRequest({
        url: encodeURI(`${MYANIMELIST_API}/manga/${parseInt(mangaId)}?fields=my_list_status`),
        method: "GET"
      }), 1);
      const malManga = MalResult(response);
      if (!malManga?.my_list_status) {
        return void 0;
      }
      return App.createMangaProgress({
        mangaId,
        lastReadChapterNumber: malManga?.my_list_status.num_chapters_read ?? 0,
        lastReadVolumeNumber: malManga?.my_list_status.num_volumes_read,
        trackedListName: malManga?.my_list_status.status ?? void 0,
        userRating: malManga?.my_list_status.score
      });
    }
    async getMangaProgressManagementForm(mangaId) {
      return App.createDUIForm({
        sections: async () => {
          const [response] = await Promise.all([
            this.requestManager.schedule(App.createRequest({
              url: encodeURI(`${MYANIMELIST_API}/manga/${parseInt(mangaId)}?fields=id,title,main_picture,alternative_titles,synopsis,mean,rank,popularity,nsfw,media_type,status,my_list_status,num_volumes,num_chapters,authors{first_name,last_name}`),
              method: "GET"
            }), 1),
            this.userInfo.refresh()
          ]);
          const malManga = MalResult(response);
          const user = await this.userInfo.get();
          if (user == null) {
            return [
              App.createDUISection({
                id: "notLoggedInSection",
                isHidden: false,
                rows: async () => [
                  App.createDUILabel({
                    id: "notLoggedIn",
                    label: "Not Logged In"
                  })
                ]
              })
            ];
          }
          if (malManga == null) {
            throw new Error(`Unable to find Manga on MyAnimeList with id ${mangaId}`);
          }
          return [
            App.createDUISection({
              id: "userInfo",
              isHidden: false,
              rows: async () => [
                App.createDUIHeader({
                  id: "header",
                  imageUrl: user.picture || "",
                  title: user.name ?? "NOT LOGGED IN",
                  subtitle: ""
                })
              ]
            }),
            // Static items
            App.createDUISection({
              id: "information",
              header: "Information",
              isHidden: false,
              rows: async () => [
                App.createDUILabel({
                  id: "mediaId",
                  label: "Manga ID",
                  value: malManga.id?.toString()
                }),
                App.createDUILabel({
                  id: "mangaTitle",
                  label: "Title",
                  value: malManga.title ?? "N/A"
                }),
                App.createDUILabel({
                  id: "mangaRank",
                  value: malManga.rank?.toString() ?? "N/A",
                  label: "Rank"
                }),
                App.createDUILabel({
                  id: "mangaPopularity",
                  value: malManga.popularity?.toString() ?? "N/A",
                  label: "Popularity"
                }),
                App.createDUILabel({
                  id: "mangaRating",
                  value: malManga.mean?.toString() ?? "N/A",
                  label: "Rating"
                }),
                App.createDUILabel({
                  id: "mangaStatus",
                  value: this.formatStatus(malManga.status),
                  label: "Status"
                }),
                App.createDUILabel({
                  id: "mangaIsAdult",
                  value: this.formatNSFW(malManga.nsfw ?? "") ? "Yes" : "No",
                  label: "Is Adult"
                })
              ]
            }),
            // User interactive items
            // Status
            App.createDUISection({
              id: "trackStatus",
              header: "Manga Status",
              footer: "Warning: Setting this to NONE will delete the listing from MyAnimeList!",
              isHidden: false,
              rows: async () => [
                App.createDUISelect({
                  id: "status",
                  //@ts-ignore
                  value: malManga.my_list_status?.status ? [malManga.my_list_status.status] : await getDefaultStatus(this.stateManager),
                  allowsMultiselect: false,
                  label: "Status",
                  labelResolver: async (value) => {
                    return this.formatStatus(value);
                  },
                  options: [
                    "NONE",
                    "reading",
                    "plan_to_read",
                    "completed",
                    "dropped",
                    "on_hold"
                  ]
                })
              ]
            }),
            // Progress
            App.createDUISection({
              id: "manage",
              header: "Progress",
              isHidden: false,
              rows: async () => [
                App.createDUIStepper({
                  id: "num_chapters_read",
                  label: "Chapter",
                  //@ts-ignore
                  value: malManga.my_list_status?.num_chapters_read ?? 0,
                  min: 0,
                  step: 1
                }),
                App.createDUIStepper({
                  id: "num_volumes_read",
                  label: "Volume",
                  //@ts-ignore
                  value: malManga.my_list_status?.num_volumes_read ?? 0,
                  min: 0,
                  step: 1
                })
              ]
            }),
            // Rating
            App.createDUISection({
              id: "rateSection",
              header: "Rating",
              isHidden: false,
              rows: async () => [
                App.createDUIStepper({
                  id: "score",
                  label: "Score",
                  //@ts-ignore
                  value: malManga.my_list_status?.score ?? 0,
                  min: 0,
                  max: 10,
                  step: 1
                })
              ]
            }),
            // Re-read
            App.createDUISection({
              id: "mangaReread",
              header: "Times Re-read",
              isHidden: false,
              rows: async () => [
                App.createDUIStepper({
                  id: "num_times_reread",
                  label: "Re-read Amount",
                  //@ts-ignore
                  value: malManga.my_list_status?.reread_value ?? 0,
                  min: 0,
                  max: 100,
                  step: 1
                })
              ]
            }),
            // Notes
            App.createDUISection({
              id: "mangaNotes",
              header: "Notes",
              isHidden: false,
              rows: async () => [
                App.createDUIInputField({
                  id: "notes",
                  label: "Notes",
                  //@ts-ignore
                  value: malManga.my_list_status?.comments ?? ""
                })
              ]
            })
          ];
        },
        onSubmit: async (values) => {
          const status = values["status"]?.[0] ?? "";
          if (status == "NONE" && mangaId != null) {
            await this.requestManager.schedule(App.createRequest({
              url: `${MYANIMELIST_API}/manga/${parseInt(mangaId)}/my_list_status`,
              method: "DELETE"
            }), 1);
          } else {
            await this.requestManager.schedule(App.createRequest({
              url: `${MYANIMELIST_API}/manga/${parseInt(mangaId)}/my_list_status`,
              method: "PUT",
              headers: {
                "content-type": "application/x-www-form-urlencoded"
              },
              data: (0, import_querystring.stringify)({
                status,
                num_chapters_read: Number(values["num_chapters_read"]),
                num_volumes_read: Number(values["num_volumes_read"]),
                score: Number(values["score"]),
                num_times_reread: Number(values["num_times_reread"]),
                comments: values["notes"]
              })
            }), 1);
          }
        }
      });
    }
    async processChapterReadActionQueue(actionQueue) {
      await this.userInfo.refresh();
      const chapterReadActions = await actionQueue.queuedChapterReadActions();
      for (const readAction of chapterReadActions) {
        const mangaId = readAction.mangaId;
        try {
          let params = {};
          if (Math.floor(readAction.chapterNumber) == 1 && !readAction.volumeNumber) {
            params = {
              status: "reading",
              // Required for API the work properly
              num_chapters_read: 1,
              num_volumes_read: 1
            };
          } else {
            params = {
              status: "reading",
              // Required for API the work properly
              num_chapters_read: Math.floor(readAction.chapterNumber),
              num_volumes_read: readAction.volumeNumber ? Math.floor(readAction.volumeNumber) : void 0
            };
          }
          const response = await this.requestManager.schedule(App.createRequest({
            url: `${MYANIMELIST_API}/manga/${parseInt(mangaId)}/my_list_status`,
            method: "PUT",
            headers: {
              "content-type": "application/x-www-form-urlencoded"
            },
            data: (0, import_querystring.stringify)(params)
          }), 0);
          if (response.status < 400) {
            await actionQueue.discardChapterReadAction(readAction);
          } else {
            console.log(`Action failed: ${response.data}`);
            await actionQueue.retryChapterReadAction(readAction);
          }
        } catch (error) {
          console.log(error);
          await actionQueue.retryChapterReadAction(readAction);
        }
      }
    }
    async getSourceMenu() {
      return App.createDUISection({
        id: "sourceMenu",
        header: "Source Menu",
        isHidden: false,
        rows: async () => {
          const isLoggedIn = await this.userInfo.isLoggedIn();
          if (isLoggedIn) {
            return [
              trackerSettings(this.stateManager),
              App.createDUILabel({
                id: "userInfo",
                label: "Logged-in as",
                value: (await this.userInfo.get())?.name ?? "ERROR"
              }),
              App.createDUIButton({
                id: "logout",
                label: "Logout",
                onTap: async () => {
                  await this.tokenData.set(void 0);
                }
              })
            ];
          } else {
            return [
              App.createDUIOAuthButton({
                id: "malLogin",
                authorizeEndpoint: "https://myanimelist.net/v1/oauth2/authorize",
                clientId: "004e72f9c4d8f5e6e8737d320246c0e3",
                label: "Login with MyAnimeList",
                redirectUri: "paperback://malAuth",
                responseType: {
                  type: "pkce",
                  pkceCodeLength: 64,
                  // eslint-disable-next-line @typescript-eslint/ban-ts-comment
                  // @ts-ignore
                  pkceCodeMethod: "plain",
                  // eslint-disable-next-line @typescript-eslint/ban-ts-comment
                  // @ts-ignore
                  formEncodeGrant: true,
                  tokenEndpoint: "https://myanimelist.net/v1/oauth2/token"
                },
                successHandler: async (accessToken, refreshToken) => {
                  const tokenBody = JSON.parse(Buffer.from(accessToken?.split(".")[1], "base64"));
                  await this.tokenData.set({
                    expires_in: tokenBody["exp"],
                    access_token: accessToken,
                    refresh_token: refreshToken
                  });
                }
              })
            ];
          }
        }
      });
    }
    // Utility
    formatNSFW(label) {
      switch (label) {
        case "white":
          return false;
        case "gray":
          return false;
        case "black":
          return true;
        default:
          return false;
      }
    }
    formatStaffName(authorNode) {
      if (!authorNode) {
        return "Unknown";
      }
      return `${authorNode.first_name} ${authorNode.last_name}`;
    }
    formatStatus(value) {
      switch (value) {
        case "reading":
          return "Reading";
        case "plan_to_read":
          return "Planned";
        case "completed":
          return "Completed";
        case "dropped":
          return "Dropped";
        case "on_hold":
          return "On-Hold";
        case "finished":
          return "Finished";
        case "currently_publishing":
          return "Releasing";
        case "not_yet_published":
          return "Not Yet Released";
        case "NONE":
          return "None";
        default:
          return "N/A";
      }
    }
    async refreshAccessToken() {
      try {
        const tokenData = await this.tokenData.get();
        const response = await this.requestManager.schedule(App.createRequest({
          url: "https://myanimelist.net/v1/oauth2/token",
          method: "POST",
          headers: {
            "content-type": "application/x-www-form-urlencoded"
          },
          data: {
            grant_type: "refresh_token",
            refresh_token: tokenData?.refresh_token,
            client_id: "004e72f9c4d8f5e6e8737d320246c0e3"
          }
        }), 1);
        const newTokenData = MalResult(response);
        if (newTokenData.access_token == null) {
          throw new Error('Unable to request new "access token", try logging out and back in!');
        }
        if (newTokenData.refresh_token == null) {
          throw new Error('Unable to request new "refresh token", try logging out and back in!');
        }
        const tokenBody = JSON.parse(Buffer.from(newTokenData.split(".")[1], "base64"));
        await this.tokenData.set({
          expires_in: tokenBody["exp"],
          access_token: newTokenData.access_token,
          refresh_token: newTokenData.refresh_token
        });
      } catch (error) {
        throw new Error(error);
      }
    }
  };
  return __toCommonJS(MyAnimeList_exports);
})();
this.Sources = _Sources; if (typeof exports === 'object' && typeof module !== 'undefined') {module.exports.Sources = this.Sources;}
