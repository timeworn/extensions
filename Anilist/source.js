"use strict";
var _Sources = (() => {
  var __create = Object.create;
  var __defProp = Object.defineProperty;
  var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
  var __getOwnPropNames = Object.getOwnPropertyNames;
  var __getProtoOf = Object.getPrototypeOf;
  var __hasOwnProp = Object.prototype.hasOwnProperty;
  var __commonJS = (cb, mod) => function __require() {
    return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;
  };
  var __export = (target, all) => {
    for (var name in all)
      __defProp(target, name, { get: all[name], enumerable: true });
  };
  var __copyProps = (to, from, except, desc) => {
    if (from && typeof from === "object" || typeof from === "function") {
      for (let key of __getOwnPropNames(from))
        if (!__hasOwnProp.call(to, key) && key !== except)
          __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
    }
    return to;
  };
  var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
    // If the importer is in node compatibility mode or this is not an ESM
    // file that has been converted to a CommonJS file using a Babel-
    // compatible transform (i.e. "__esModule" has not been set), then set
    // "default" to the CommonJS "module.exports" for node compatibility.
    isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
    mod
  ));
  var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

  // node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUIBinding.js
  var require_DUIBinding = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUIBinding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUIForm.js
  var require_DUIForm = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUIForm.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUIFormRow.js
  var require_DUIFormRow = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUIFormRow.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUISection.js
  var require_DUISection = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Exports/DUISection.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIButton.js
  var require_DUIButton = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIButton.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIHeader.js
  var require_DUIHeader = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIHeader.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIInputField.js
  var require_DUIInputField = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIInputField.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUILabel.js
  var require_DUILabel = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUILabel.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUILink.js
  var require_DUILink = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUILink.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIMultilineLabel.js
  var require_DUIMultilineLabel = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIMultilineLabel.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUINavigationButton.js
  var require_DUINavigationButton = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUINavigationButton.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIOAuthButton.js
  var require_DUIOAuthButton = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIOAuthButton.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUISecureInputField.js
  var require_DUISecureInputField = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUISecureInputField.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUISelect.js
  var require_DUISelect = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUISelect.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIStepper.js
  var require_DUIStepper = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUIStepper.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUISwitch.js
  var require_DUISwitch = __commonJS({
    "node_modules/@paperback/types/lib/generated/DynamicUI/Rows/Exports/DUISwitch.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/ChapterDetails.js
  var require_ChapterDetails = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/ChapterDetails.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/Chapter.js
  var require_Chapter = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/Chapter.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/Cookie.js
  var require_Cookie = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/Cookie.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/HomeSection.js
  var require_HomeSection = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/HomeSection.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/IconText.js
  var require_IconText = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/IconText.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/MangaInfo.js
  var require_MangaInfo = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/MangaInfo.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/MangaProgress.js
  var require_MangaProgress = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/MangaProgress.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/PartialSourceManga.js
  var require_PartialSourceManga = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/PartialSourceManga.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/MangaUpdates.js
  var require_MangaUpdates = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/MangaUpdates.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/PBCanvas.js
  var require_PBCanvas = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/PBCanvas.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/PBImage.js
  var require_PBImage = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/PBImage.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/PagedResults.js
  var require_PagedResults = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/PagedResults.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/RawData.js
  var require_RawData = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/RawData.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/Request.js
  var require_Request = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/Request.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SourceInterceptor.js
  var require_SourceInterceptor = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SourceInterceptor.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/RequestManager.js
  var require_RequestManager = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/RequestManager.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/Response.js
  var require_Response = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/Response.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SearchField.js
  var require_SearchField = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SearchField.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SearchRequest.js
  var require_SearchRequest = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SearchRequest.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SourceCookieStore.js
  var require_SourceCookieStore = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SourceCookieStore.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SourceManga.js
  var require_SourceManga = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SourceManga.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SecureStateManager.js
  var require_SecureStateManager = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SecureStateManager.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/SourceStateManager.js
  var require_SourceStateManager = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/SourceStateManager.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/Tag.js
  var require_Tag = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/Tag.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/TagSection.js
  var require_TagSection = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/TagSection.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/TrackedMangaChapterReadAction.js
  var require_TrackedMangaChapterReadAction = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/TrackedMangaChapterReadAction.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/Exports/TrackerActionQueue.js
  var require_TrackerActionQueue = __commonJS({
    "node_modules/@paperback/types/lib/generated/Exports/TrackerActionQueue.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/generated/_exports.js
  var require_exports = __commonJS({
    "node_modules/@paperback/types/lib/generated/_exports.js"(exports) {
      "use strict";
      var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        var desc = Object.getOwnPropertyDescriptor(m, k);
        if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
          desc = { enumerable: true, get: function() {
            return m[k];
          } };
        }
        Object.defineProperty(o, k2, desc);
      } : function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        o[k2] = m[k];
      });
      var __exportStar = exports && exports.__exportStar || function(m, exports2) {
        for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p)) __createBinding(exports2, m, p);
      };
      Object.defineProperty(exports, "__esModule", { value: true });
      __exportStar(require_DUIBinding(), exports);
      __exportStar(require_DUIForm(), exports);
      __exportStar(require_DUIFormRow(), exports);
      __exportStar(require_DUISection(), exports);
      __exportStar(require_DUIButton(), exports);
      __exportStar(require_DUIHeader(), exports);
      __exportStar(require_DUIInputField(), exports);
      __exportStar(require_DUILabel(), exports);
      __exportStar(require_DUILink(), exports);
      __exportStar(require_DUIMultilineLabel(), exports);
      __exportStar(require_DUINavigationButton(), exports);
      __exportStar(require_DUIOAuthButton(), exports);
      __exportStar(require_DUISecureInputField(), exports);
      __exportStar(require_DUISelect(), exports);
      __exportStar(require_DUIStepper(), exports);
      __exportStar(require_DUISwitch(), exports);
      __exportStar(require_ChapterDetails(), exports);
      __exportStar(require_Chapter(), exports);
      __exportStar(require_Cookie(), exports);
      __exportStar(require_HomeSection(), exports);
      __exportStar(require_IconText(), exports);
      __exportStar(require_MangaInfo(), exports);
      __exportStar(require_MangaProgress(), exports);
      __exportStar(require_PartialSourceManga(), exports);
      __exportStar(require_MangaUpdates(), exports);
      __exportStar(require_PBCanvas(), exports);
      __exportStar(require_PBImage(), exports);
      __exportStar(require_PagedResults(), exports);
      __exportStar(require_RawData(), exports);
      __exportStar(require_Request(), exports);
      __exportStar(require_SourceInterceptor(), exports);
      __exportStar(require_RequestManager(), exports);
      __exportStar(require_Response(), exports);
      __exportStar(require_SearchField(), exports);
      __exportStar(require_SearchRequest(), exports);
      __exportStar(require_SourceCookieStore(), exports);
      __exportStar(require_SourceManga(), exports);
      __exportStar(require_SecureStateManager(), exports);
      __exportStar(require_SourceStateManager(), exports);
      __exportStar(require_Tag(), exports);
      __exportStar(require_TagSection(), exports);
      __exportStar(require_TrackedMangaChapterReadAction(), exports);
      __exportStar(require_TrackerActionQueue(), exports);
    }
  });

  // node_modules/@paperback/types/lib/base/Source.js
  var require_Source = __commonJS({
    "node_modules/@paperback/types/lib/base/Source.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.urlEncodeObject = exports.convertTime = exports.Source = void 0;
      var Source = class {
        constructor(cheerio) {
          this.cheerio = cheerio;
        }
        /**
         * @deprecated use {@link Source.getSearchResults getSearchResults} instead
         */
        searchRequest(query, metadata) {
          return this.getSearchResults(query, metadata);
        }
        /**
         * @deprecated use {@link Source.getSearchTags} instead
         */
        async getTags() {
          return this.getSearchTags?.();
        }
      };
      exports.Source = Source;
      function convertTime(timeAgo) {
        let time;
        let trimmed = Number((/\d*/.exec(timeAgo) ?? [])[0]);
        trimmed = trimmed == 0 && timeAgo.includes("a") ? 1 : trimmed;
        if (timeAgo.includes("minutes")) {
          time = new Date(Date.now() - trimmed * 6e4);
        } else if (timeAgo.includes("hours")) {
          time = new Date(Date.now() - trimmed * 36e5);
        } else if (timeAgo.includes("days")) {
          time = new Date(Date.now() - trimmed * 864e5);
        } else if (timeAgo.includes("year") || timeAgo.includes("years")) {
          time = new Date(Date.now() - trimmed * 31556952e3);
        } else {
          time = new Date(Date.now());
        }
        return time;
      }
      exports.convertTime = convertTime;
      function urlEncodeObject(obj) {
        let ret = {};
        for (const entry of Object.entries(obj)) {
          ret[encodeURIComponent(entry[0])] = encodeURIComponent(entry[1]);
        }
        return ret;
      }
      exports.urlEncodeObject = urlEncodeObject;
    }
  });

  // node_modules/@paperback/types/lib/base/ByteArray.js
  var require_ByteArray = __commonJS({
    "node_modules/@paperback/types/lib/base/ByteArray.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/Badge.js
  var require_Badge = __commonJS({
    "node_modules/@paperback/types/lib/base/Badge.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.BadgeColor = void 0;
      var BadgeColor;
      (function(BadgeColor2) {
        BadgeColor2["BLUE"] = "default";
        BadgeColor2["GREEN"] = "success";
        BadgeColor2["GREY"] = "info";
        BadgeColor2["YELLOW"] = "warning";
        BadgeColor2["RED"] = "danger";
      })(BadgeColor = exports.BadgeColor || (exports.BadgeColor = {}));
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/ChapterProviding.js
  var require_ChapterProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/ChapterProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/CloudflareBypassRequestProviding.js
  var require_CloudflareBypassRequestProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/CloudflareBypassRequestProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/HomePageSectionsProviding.js
  var require_HomePageSectionsProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/HomePageSectionsProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/MangaProgressProviding.js
  var require_MangaProgressProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/MangaProgressProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/MangaProviding.js
  var require_MangaProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/MangaProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/RequestManagerProviding.js
  var require_RequestManagerProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/RequestManagerProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/SearchResultsProviding.js
  var require_SearchResultsProviding = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/SearchResultsProviding.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/interfaces/index.js
  var require_interfaces = __commonJS({
    "node_modules/@paperback/types/lib/base/interfaces/index.js"(exports) {
      "use strict";
      var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        var desc = Object.getOwnPropertyDescriptor(m, k);
        if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
          desc = { enumerable: true, get: function() {
            return m[k];
          } };
        }
        Object.defineProperty(o, k2, desc);
      } : function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        o[k2] = m[k];
      });
      var __exportStar = exports && exports.__exportStar || function(m, exports2) {
        for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p)) __createBinding(exports2, m, p);
      };
      Object.defineProperty(exports, "__esModule", { value: true });
      __exportStar(require_ChapterProviding(), exports);
      __exportStar(require_CloudflareBypassRequestProviding(), exports);
      __exportStar(require_HomePageSectionsProviding(), exports);
      __exportStar(require_MangaProgressProviding(), exports);
      __exportStar(require_MangaProviding(), exports);
      __exportStar(require_RequestManagerProviding(), exports);
      __exportStar(require_SearchResultsProviding(), exports);
    }
  });

  // node_modules/@paperback/types/lib/base/SourceInfo.js
  var require_SourceInfo = __commonJS({
    "node_modules/@paperback/types/lib/base/SourceInfo.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.ContentRating = exports.SourceIntents = void 0;
      var SourceIntents2;
      (function(SourceIntents3) {
        SourceIntents3[SourceIntents3["MANGA_CHAPTERS"] = 1] = "MANGA_CHAPTERS";
        SourceIntents3[SourceIntents3["MANGA_TRACKING"] = 2] = "MANGA_TRACKING";
        SourceIntents3[SourceIntents3["HOMEPAGE_SECTIONS"] = 4] = "HOMEPAGE_SECTIONS";
        SourceIntents3[SourceIntents3["COLLECTION_MANAGEMENT"] = 8] = "COLLECTION_MANAGEMENT";
        SourceIntents3[SourceIntents3["CLOUDFLARE_BYPASS_REQUIRED"] = 16] = "CLOUDFLARE_BYPASS_REQUIRED";
        SourceIntents3[SourceIntents3["SETTINGS_UI"] = 32] = "SETTINGS_UI";
      })(SourceIntents2 = exports.SourceIntents || (exports.SourceIntents = {}));
      var ContentRating2;
      (function(ContentRating3) {
        ContentRating3["EVERYONE"] = "EVERYONE";
        ContentRating3["MATURE"] = "MATURE";
        ContentRating3["ADULT"] = "ADULT";
      })(ContentRating2 = exports.ContentRating || (exports.ContentRating = {}));
    }
  });

  // node_modules/@paperback/types/lib/base/HomeSectionType.js
  var require_HomeSectionType = __commonJS({
    "node_modules/@paperback/types/lib/base/HomeSectionType.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.HomeSectionType = void 0;
      var HomeSectionType;
      (function(HomeSectionType2) {
        HomeSectionType2["singleRowNormal"] = "singleRowNormal";
        HomeSectionType2["singleRowLarge"] = "singleRowLarge";
        HomeSectionType2["doubleRow"] = "doubleRow";
        HomeSectionType2["featured"] = "featured";
      })(HomeSectionType = exports.HomeSectionType || (exports.HomeSectionType = {}));
    }
  });

  // node_modules/@paperback/types/lib/base/PaperbackExtensionBase.js
  var require_PaperbackExtensionBase = __commonJS({
    "node_modules/@paperback/types/lib/base/PaperbackExtensionBase.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/base/index.js
  var require_base = __commonJS({
    "node_modules/@paperback/types/lib/base/index.js"(exports) {
      "use strict";
      var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        var desc = Object.getOwnPropertyDescriptor(m, k);
        if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
          desc = { enumerable: true, get: function() {
            return m[k];
          } };
        }
        Object.defineProperty(o, k2, desc);
      } : function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        o[k2] = m[k];
      });
      var __exportStar = exports && exports.__exportStar || function(m, exports2) {
        for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p)) __createBinding(exports2, m, p);
      };
      Object.defineProperty(exports, "__esModule", { value: true });
      __exportStar(require_Source(), exports);
      __exportStar(require_ByteArray(), exports);
      __exportStar(require_Badge(), exports);
      __exportStar(require_interfaces(), exports);
      __exportStar(require_SourceInfo(), exports);
      __exportStar(require_HomeSectionType(), exports);
      __exportStar(require_PaperbackExtensionBase(), exports);
    }
  });

  // node_modules/@paperback/types/lib/compat/DyamicUI.js
  var require_DyamicUI = __commonJS({
    "node_modules/@paperback/types/lib/compat/DyamicUI.js"(exports) {
      "use strict";
      Object.defineProperty(exports, "__esModule", { value: true });
    }
  });

  // node_modules/@paperback/types/lib/index.js
  var require_lib = __commonJS({
    "node_modules/@paperback/types/lib/index.js"(exports) {
      "use strict";
      var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        var desc = Object.getOwnPropertyDescriptor(m, k);
        if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
          desc = { enumerable: true, get: function() {
            return m[k];
          } };
        }
        Object.defineProperty(o, k2, desc);
      } : function(o, m, k, k2) {
        if (k2 === void 0) k2 = k;
        o[k2] = m[k];
      });
      var __exportStar = exports && exports.__exportStar || function(m, exports2) {
        for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p)) __createBinding(exports2, m, p);
      };
      Object.defineProperty(exports, "__esModule", { value: true });
      __exportStar(require_exports(), exports);
      __exportStar(require_base(), exports);
      __exportStar(require_DyamicUI(), exports);
    }
  });

  // src/Anilist/Anilist.ts
  var Anilist_exports = {};
  __export(Anilist_exports, {
    Anilist: () => Anilist,
    AnilistInfo: () => AnilistInfo
  });
  var import_types = __toESM(require_lib());

  // src/Anilist/models/graphql-queries.ts
  var userProfileQuery = () => ({
    query: `{
        Viewer {
            id
            name
            avatar {
                large
            }
            mediaListOptions {
                scoreFormat
            }
            siteUrl
        }
    }`
  });
  var searchMangaQuery = (page, search) => ({
    query: `query($page: Int, $search: String) {
        Page(page: $page) {
            pageInfo {
                currentPage
                hasNextPage
            }
            media(type: MANGA, search: $search, format_not: NOVEL) {
                id
                title {
                    userPreferred
                }
                coverImage {
                    large
                }
            }
        }
    }`,
    variables: {
      page,
      search
    }
  });
  var getMangaQuery = (id) => ({
    query: `query($id: Int){
        Media(id: $id){
            id
            description(asHtml: false)
            title {
                romaji
                english
                native
            }
            coverImage{
                extraLarge
            }
            bannerImage
            averageScore
            isAdult
            popularity
            characters(sort: RELEVANCE, perPage: 25) {
                edges {
                    node {
                        image {
                            large
                        }
                        age
                    }
                    name
                    role
                }
            }
            staff {
                edges {
                    node {
                        name {
                            full
                        }
                        image {
                            large
                        }
                    }
                    role
                }
            }
            status
        }
    }`,
    variables: {
      id
    }
  });
  var getMangaProgressQuery = (id) => ({
    query: `query($id: Int) {
        Media(id: $id) {
            id
            mediaListEntry {
                id
                status
                progress
                progressVolumes
                repeat
                private
                hiddenFromStatusLists
                score
                notes
            }
            title {
                romaji
                english
                native
                userPreferred
            }
            coverImage {
                extraLarge
            }
            bannerImage
            averageScore
            isAdult
            popularity
            status
        }
    }`,
    variables: {
      id
    }
  });
  var saveMangaProgressMutation = (variables) => ({
    query: `mutation($id: Int, $mediaId: Int, $status: MediaListStatus, $score: Float, $progress: Int, $progressVolumes: Int, $repeat: Int, $notes: String, $private: Boolean, $hiddenFromStatusLists: Boolean, $completedAt: FuzzyDate) {
        SaveMediaListEntry(id: $id, mediaId: $mediaId, status: $status, score: $score, progress: $progress, progressVolumes: $progressVolumes, repeat: $repeat, notes: $notes, private: $private, hiddenFromStatusLists: $hiddenFromStatusLists, completedAt: $completedAt) {
            id
        }
    }`,
    variables
  });
  var deleteMangaProgressMutation = (id) => ({
    query: `mutation($id: Int) {
        DeleteMediaListEntry(id: $id){
            deleted
        }
    }`,
    variables: {
      id
    }
  });

  // src/Anilist/models/anilist-result.ts
  function AnilistResult(json) {
    const result = typeof json == "string" ? JSON.parse(json) : json;
    if (result.errors?.length ?? 0 > 0) {
      result.errors?.map((error) => {
        console.log(`[ANILIST-ERROR(${error.status})] ${error.message}`);
      });
      throw new Error("Error while fetching data from Anilist, check logs for more info");
    }
    return result;
  }

  // src/Anilist/AlSettings.ts
  var getDefaultStatus = async (stateManager) => {
    return await stateManager.retrieve("defaultStatus") ?? ["NONE"];
  };
  var getDefaultPrivate = async (stateManager) => {
    return await stateManager.retrieve("defaultPrivate") ?? ["NEVER"];
  };
  var getDefaultHideFromStatusLists = async (stateManager) => {
    return await stateManager.retrieve("defaultHideFromActivity") ?? ["NEVER"];
  };
  var trackerSettings = (stateManager) => {
    return App.createDUINavigationButton({
      id: "tracker_settings",
      label: "Tracker Settings",
      form: App.createDUIForm({
        sections: () => {
          return Promise.resolve([
            App.createDUISection({
              id: "status_settings",
              header: "Status Settings",
              isHidden: false,
              rows: async () => [
                App.createDUISelect({
                  id: "defaultStatus",
                  label: "Default Status",
                  allowsMultiselect: false,
                  value: App.createDUIBinding({
                    get: () => getDefaultStatus(stateManager),
                    set: async (newValue) => await stateManager.store("defaultStatus", newValue)
                  }),
                  labelResolver: async (value) => {
                    switch (value) {
                      case "CURRENT":
                        return "Reading";
                      case "PLANNING":
                        return "Planned";
                      case "COMPLETED":
                        return "Completed";
                      case "DROPPED":
                        return "Dropped";
                      case "PAUSED":
                        return "On-Hold";
                      case "REPEATING":
                        return "Re-Reading";
                      default:
                        return "None";
                    }
                  },
                  options: ["NONE", "CURRENT", "PLANNING", "COMPLETED", "DROPPED", "PAUSED", "REPEATING"]
                })
              ]
            }),
            App.createDUISection({
              id: "privacy_settings",
              header: "Privacy Settings",
              isHidden: false,
              rows: async () => [
                App.createDUISelect({
                  id: "defaultPrivate",
                  label: "Private by Default",
                  allowsMultiselect: false,
                  value: App.createDUIBinding({
                    get: () => getDefaultPrivate(stateManager),
                    set: async (newValue) => await stateManager.store("defaultPrivate", newValue)
                  }),
                  labelResolver: async (value) => {
                    switch (value) {
                      case "ALWAYS":
                        return "Always";
                      case "ADULTONLY":
                        return "Adult Only";
                      default:
                        return "Never";
                    }
                  },
                  options: ["NEVER", "ADULTONLY", "ALWAYS"]
                }),
                App.createDUISelect({
                  id: "defaultHideFromStatusLists",
                  label: "Hide from Status List by Default",
                  allowsMultiselect: false,
                  value: App.createDUIBinding({
                    get: () => getDefaultHideFromStatusLists(stateManager),
                    set: async (newValue) => await stateManager.store("defaultHideFromActivity", newValue)
                  }),
                  labelResolver: async (value) => {
                    switch (value) {
                      case "ALWAYS":
                        return "Always";
                      case "ADULTONLY":
                        return "Adult Only";
                      default:
                        return "Never";
                    }
                  },
                  options: ["NEVER", "ADULTONLY", "ALWAYS"]
                })
              ]
            })
          ]);
        }
      })
    });
  };

  // src/Anilist/Anilist.ts
  var ANILIST_GRAPHQL_ENDPOINT = "https://graphql.anilist.co/";
  var AnilistInfo = {
    name: "Anilist",
    author: "Faizan Durrani \u2665 Netsky",
    contentRating: import_types.ContentRating.EVERYONE,
    icon: "icon.png",
    version: "1.1.8",
    description: "Modified Anilist Tracker",
    websiteBaseURL: "https://anilist.co",
    intents: import_types.SourceIntents.MANGA_TRACKING | import_types.SourceIntents.SETTINGS_UI
  };
  var Anilist = class {
    constructor() {
      this.stateManager = App.createSourceStateManager();
      this.requestManager = App.createRequestManager({
        requestsPerSecond: 2.5,
        requestTimeout: 2e4,
        interceptor: {
          // Authorization injector
          interceptRequest: async (request) => {
            const accessToken = await this.accessToken.get();
            request.headers = {
              ...request.headers ?? {},
              ...{
                "content-type": "application/json",
                "accept": "application/json"
              },
              ...accessToken != null ? {
                "authorization": `Bearer ${accessToken}`
              } : {}
            };
            return request;
          },
          interceptResponse: async (response) => {
            return response;
          }
        }
      });
      this.accessToken = {
        get: async () => {
          return this.stateManager.keychain.retrieve("access_token");
        },
        set: async (token) => {
          await this.stateManager.keychain.store("access_token", token);
          await this.userInfo.refresh();
        },
        isValid: async () => {
          return await this.accessToken.get() != null;
        }
      };
      this.userInfo = {
        get: async () => {
          return this.stateManager.retrieve("userInfo");
        },
        isLoggedIn: async () => {
          return await this.userInfo.get() != null;
        },
        refresh: async () => {
          const accessToken = await this.accessToken.get();
          if (accessToken == null) {
            return this.stateManager.store("userInfo", void 0);
          }
          const response = await this.requestManager.schedule(App.createRequest({
            url: ANILIST_GRAPHQL_ENDPOINT,
            method: "POST",
            data: userProfileQuery()
          }), 0);
          const userInfo = AnilistResult(response.data).data?.Viewer;
          await this.stateManager.store("userInfo", userInfo);
        }
      };
    }
    async getSearchResults(query, metadata) {
      const pageInfo = metadata;
      if (pageInfo?.hasNextPage === false) {
        return App.createPagedResults({ results: [], metadata: pageInfo });
      }
      const nextPage = (pageInfo?.currentPage ?? 0) + 1;
      const response = await this.requestManager.schedule(App.createRequest({
        url: ANILIST_GRAPHQL_ENDPOINT,
        method: "POST",
        data: searchMangaQuery(nextPage, query.title ?? "")
      }), 1);
      const anilistPage = AnilistResult(response.data).data?.Page;
      return App.createPagedResults({
        results: anilistPage?.media.map((manga) => App.createPartialSourceManga({
          image: manga.coverImage.large ?? "",
          title: manga.title.userPreferred,
          mangaId: manga.id.toString(),
          subtitle: void 0
        })) ?? [],
        metadata: anilistPage?.pageInfo
      });
    }
    async getMangaProgress(mangaId) {
      const response = await this.requestManager.schedule(App.createRequest({
        url: ANILIST_GRAPHQL_ENDPOINT,
        method: "POST",
        data: getMangaProgressQuery(parseInt(mangaId))
      }), 1);
      const anilistManga = AnilistResult(response.data).data?.Media;
      if (!anilistManga?.mediaListEntry) {
        return void 0;
      }
      return App.createMangaProgress({
        mangaId,
        lastReadChapterNumber: anilistManga.mediaListEntry.progress ?? 0,
        lastReadVolumeNumber: anilistManga.mediaListEntry.progressVolumes,
        trackedListName: anilistManga.mediaListEntry.status,
        userRating: anilistManga.mediaListEntry.score
      });
    }
    async getMangaProgressManagementForm(mangaId) {
      const tempData = {};
      return App.createDUIForm({
        sections: async () => {
          const [response] = await Promise.all([
            this.requestManager.schedule(App.createRequest({
              url: ANILIST_GRAPHQL_ENDPOINT,
              method: "POST",
              data: getMangaProgressQuery(parseInt(mangaId))
            }), 1),
            this.userInfo.refresh()
          ]);
          const anilistManga = AnilistResult(response.data).data?.Media;
          const user = await this.userInfo.get();
          if (user == null) {
            return [
              App.createDUISection({
                id: "notLoggedInSection",
                isHidden: false,
                rows: async () => [
                  App.createDUILabel({
                    id: "notLoggedIn",
                    label: "Not Logged In"
                  })
                ]
              })
            ];
          }
          if (anilistManga == null) {
            throw new Error(`Unable to find Manga on Anilist with id ${mangaId}`);
          }
          Object.assign(tempData, { id: anilistManga.mediaListEntry?.id, mediaId: anilistManga.id });
          return [
            App.createDUISection({
              id: "userInfo",
              isHidden: false,
              rows: async () => [
                App.createDUIHeader({
                  id: "header",
                  imageUrl: user.avatar?.large || "",
                  title: user.name ?? "NOT LOGGED IN",
                  subtitle: ""
                })
              ]
            }),
            // Static items
            App.createDUISection({
              id: "information",
              header: "Information",
              isHidden: false,
              rows: async () => [
                // This allows us to get the id when the form is submitted
                ...anilistManga.mediaListEntry != null ? [App.createDUILabel({
                  id: "id",
                  label: "Entry ID",
                  value: anilistManga.mediaListEntry?.id?.toString()
                })] : [],
                App.createDUILabel({
                  id: "mediaId",
                  label: "Manga ID",
                  value: anilistManga.id?.toString()
                }),
                App.createDUILabel({
                  id: "mangaTitle",
                  label: "Title",
                  value: anilistManga.title?.userPreferred ?? "N/A"
                }),
                App.createDUILabel({
                  id: "mangaPopularity",
                  value: anilistManga.popularity?.toString() ?? "N/A",
                  label: "Popularity"
                }),
                App.createDUILabel({
                  id: "mangaRating",
                  value: anilistManga.averageScore?.toString() ?? "N/A",
                  label: "Rating"
                }),
                App.createDUILabel({
                  id: "mangaStatus",
                  value: this.formatStatus(anilistManga.status),
                  label: "Status"
                }),
                App.createDUILabel({
                  id: "mangaIsAdult",
                  value: anilistManga.isAdult ? "Yes" : "No",
                  label: "Is Adult"
                })
              ]
            }),
            // User interactive items
            // Status
            App.createDUISection({
              id: "trackStatus",
              header: "Manga Status",
              footer: "Warning: Setting this to NONE will delete the listing from Anilist",
              isHidden: false,
              rows: async () => [
                App.createDUISelect({
                  id: "status",
                  //@ts-ignore
                  value: anilistManga.mediaListEntry?.status ? [anilistManga.mediaListEntry.status] : await getDefaultStatus(this.stateManager),
                  allowsMultiselect: false,
                  label: "Status",
                  labelResolver: async (value) => {
                    return this.formatStatus(value);
                  },
                  options: [
                    "NONE",
                    "CURRENT",
                    "PLANNING",
                    "COMPLETED",
                    "DROPPED",
                    "PAUSED",
                    "REPEATING"
                  ]
                })
              ]
            }),
            // Progress
            App.createDUISection({
              id: "manage",
              header: "Progress",
              isHidden: false,
              rows: async () => [
                App.createDUIStepper({
                  id: "progress",
                  label: "Chapter",
                  //@ts-ignore
                  value: anilistManga.mediaListEntry?.progress ?? 0,
                  min: 0,
                  step: 1
                }),
                App.createDUIStepper({
                  id: "progressVolumes",
                  label: "Volume",
                  //@ts-ignore
                  value: anilistManga.mediaListEntry?.progressVolumes ?? 0,
                  min: 0,
                  step: 1
                }),
                App.createDUIStepper({
                  id: "repeat",
                  label: "Times Re-Read",
                  //@ts-ignore
                  value: anilistManga.mediaListEntry?.repeat != void 0 ? anilistManga.mediaListEntry?.repeat : 0,
                  min: 0,
                  step: 1
                }),
                App.createDUILabel({
                  id: "start",
                  value: this.formatFuzzyDate(anilistManga.mediaListEntry?.startedAt),
                  label: "Start Date"
                }),
                App.createDUILabel({
                  id: "finish",
                  value: this.formatFuzzyDate(anilistManga.mediaListEntry?.completedAt),
                  label: "Finish Date"
                })
              ]
            }),
            // Rating
            App.createDUISection({
              id: "rateSection",
              header: "Rating",
              footer: "This uses your rating preference set on AniList",
              isHidden: false,
              rows: async () => [
                App.createDUIStepper({
                  id: "score",
                  label: "Score",
                  //@ts-ignore
                  value: anilistManga.mediaListEntry?.score ?? 0,
                  min: 0,
                  max: this.scoreFormatLimit(user.mediaListOptions?.scoreFormat ?? "POINT_10"),
                  step: user.mediaListOptions?.scoreFormat?.includes("DECIMAL") === true ? 0.1 : 1
                })
              ]
            }),
            // privacy
            App.createDUISection({
              id: "privacy_settings",
              header: "Privacy Settings",
              isHidden: false,
              rows: async () => [
                App.createDUISwitch({
                  id: "private",
                  label: "Private",
                  //@ts-ignore
                  value: anilistManga.mediaListEntry?.private != void 0 ? anilistManga.mediaListEntry.private : await getDefaultPrivate(this.stateManager) == "ADULTONLY" && anilistManga.isAdult || await getDefaultPrivate(this.stateManager) == "ALWAYS" ? true : false
                }),
                App.createDUISwitch({
                  id: "hiddenFromStatusLists",
                  label: "Hide From Status List",
                  //@ts-ignore
                  value: anilistManga.mediaListEntry?.hiddenFromStatusLists != void 0 ? anilistManga.mediaListEntry.hiddenFromStatusLists : await getDefaultHideFromStatusLists(this.stateManager) == "ADULTONLY" && anilistManga.isAdult || await getDefaultHideFromStatusLists(this.stateManager) == "ALWAYS" ? true : false
                })
              ]
            }),
            // Notes
            App.createDUISection({
              id: "mangaNotes",
              header: "Notes",
              isHidden: false,
              rows: async () => [
                App.createDUIInputField({
                  id: "notes",
                  label: "Notes",
                  //@ts-ignore
                  value: anilistManga.mediaListEntry?.notes ?? ""
                })
              ]
            })
          ];
        },
        onSubmit: async (values) => {
          let mutation;
          const status = values["status"]?.[0] ?? "";
          const id = tempData.id ? Number(tempData.id) : void 0;
          const mediaId = Number(tempData.mediaId);
          let mutationData = {};
          if (status == "COMPLETED") {
            if (this.reverseFormatFuzzyDate(values["finish"]) == null) {
              const now = /* @__PURE__ */ new Date();
              mutationData = {
                completedAt: {
                  year: now.getFullYear(),
                  month: now.getMonth() + 1,
                  day: now.getDate()
                }
              };
            }
          }
          if (status == "NONE" && id != null) {
            mutation = deleteMangaProgressMutation(id);
          } else {
            mutationData = {
              ...mutationData,
              id,
              mediaId,
              status,
              notes: values["notes"],
              progress: values["progress"],
              progressVolumes: values["progressVolumes"],
              repeat: values["repeat"],
              private: values["private"],
              hiddenFromStatusLists: values["hiddenFromStatusLists"],
              score: Number(values["score"])
            };
            mutation = saveMangaProgressMutation(mutationData);
          }
          console.log(JSON.stringify(mutation, null, 2));
          console.log(JSON.stringify(mutationData));
          await this.requestManager.schedule(App.createRequest({
            url: ANILIST_GRAPHQL_ENDPOINT,
            method: "POST",
            data: mutation
          }), 1);
        }
      });
    }
    async getMangaDetails(mangaId) {
      const response = await this.requestManager.schedule(App.createRequest({
        url: ANILIST_GRAPHQL_ENDPOINT,
        method: "POST",
        data: getMangaQuery(parseInt(mangaId))
      }), 1);
      const anilistManga = AnilistResult(response.data).data?.Media;
      if (anilistManga == null) {
        return Promise.reject();
      }
      return App.createSourceManga({
        id: mangaId,
        mangaInfo: App.createMangaInfo({
          image: anilistManga.coverImage?.extraLarge ?? "",
          titles: [
            anilistManga.title?.romaji,
            anilistManga.title?.english,
            anilistManga.title?.native
          ].filter((x) => x != null),
          artist: anilistManga.staff?.edges?.find((x) => x?.role?.toLowerCase() == "art")?.node?.name?.full ?? "Unknown",
          author: anilistManga.staff?.edges?.find((x) => x?.role?.toLowerCase() == "story")?.node?.name?.full ?? "Unknown",
          desc: anilistManga?.description || "",
          hentai: anilistManga.isAdult,
          rating: anilistManga.averageScore,
          // eslint-disable-next-line @typescript-eslint/ban-ts-comment
          // @ts-ignore
          status: anilistManga.status,
          banner: anilistManga.bannerImage
        })
      });
    }
    async getSourceMenu() {
      return App.createDUISection({
        id: "sourceMenu",
        header: "Source Menu",
        isHidden: false,
        rows: async () => {
          const isLoggedIn = await this.userInfo.isLoggedIn();
          if (isLoggedIn) {
            return [
              trackerSettings(this.stateManager),
              App.createDUILabel({
                id: "userInfo",
                label: "Logged-in as",
                value: (await this.userInfo.get())?.name ?? "ERROR"
              }),
              App.createDUIButton({
                id: "logout",
                label: "Logout",
                onTap: async () => {
                  await this.accessToken.set(void 0);
                }
              })
            ];
          } else {
            return [
              trackerSettings(this.stateManager),
              App.createDUIOAuthButton({
                id: "anilistLogin",
                authorizeEndpoint: "https://anilist.co/api/v2/oauth/authorize",
                clientId: "5459",
                label: "Login with Anilist",
                responseType: {
                  type: "token"
                },
                successHandler: async (token) => {
                  await this.accessToken.set(token);
                }
              })
            ];
          }
        }
      });
    }
    async processChapterReadActionQueue(actionQueue) {
      await this.userInfo.refresh();
      const chapterReadActions = await actionQueue.queuedChapterReadActions();
      const anilistMangaCache = {};
      for (const readAction of chapterReadActions) {
        try {
          let anilistManga = anilistMangaCache[readAction.mangaId];
          if (!anilistManga) {
            const _response = await this.requestManager.schedule(App.createRequest({
              url: ANILIST_GRAPHQL_ENDPOINT,
              method: "POST",
              data: getMangaProgressQuery(parseInt(readAction.mangaId))
            }), 0);
            anilistManga = AnilistResult(_response.data).data?.Media;
            anilistMangaCache[readAction.mangaId] = anilistManga;
          }
          if (anilistManga?.mediaListEntry) {
            if (anilistManga.mediaListEntry.progress && anilistManga.mediaListEntry.progress >= Math.floor(readAction.chapterNumber)) {
              await actionQueue.discardChapterReadAction(readAction);
              continue;
            }
          }
          let params = {};
          if (Math.floor(readAction.chapterNumber) == 1 && !readAction.volumeNumber) {
            params = {
              mediaId: readAction.mangaId,
              progress: 1,
              progressVolumes: 1
            };
            if (anilistManga?.mediaListEntry?.startedAt == null) {
              const now = /* @__PURE__ */ new Date();
              params = {
                ...params,
                startedAt: {
                  year: now.getFullYear(),
                  month: now.getMonth() + 1,
                  day: now.getDate()
                }
              };
            }
          } else {
            params = {
              mediaId: readAction.mangaId,
              progress: Math.floor(readAction.chapterNumber),
              progressVolumes: readAction.volumeNumber ? Math.floor(readAction.volumeNumber) : void 0
            };
          }
          const response = await this.requestManager.schedule(App.createRequest({
            url: ANILIST_GRAPHQL_ENDPOINT,
            method: "POST",
            data: saveMangaProgressMutation(params)
          }), 0);
          if (response.status < 400) {
            await actionQueue.discardChapterReadAction(readAction);
            anilistMangaCache[readAction.mangaId] = {
              mediaListEntry: {
                progress: Math.floor(readAction.chapterNumber),
                progressVolumes: readAction.volumeNumber ? Math.floor(readAction.volumeNumber) : void 0
              }
            };
          } else {
            console.log(`Action failed: ${response.data}`);
            await actionQueue.retryChapterReadAction(readAction);
          }
        } catch (error) {
          console.log(error);
          await actionQueue.retryChapterReadAction(readAction);
        }
      }
    }
    // Utility
    scoreFormatLimit(format) {
      const extracted = /\d+/gi.exec(format)?.[0];
      return extracted != null ? Number(extracted) : void 0;
    }
    formatStatus(value) {
      switch (value) {
        case "CURRENT":
          return "Reading";
        case "PLANNING":
          return "Planned";
        case "COMPLETED":
          return "Completed";
        case "DROPPED":
          return "Dropped";
        case "PAUSED":
          return "On-Hold";
        case "REPEATING":
          return "Re-Reading";
        case "FINISHED":
          return "Finished";
        case "RELEASING":
          return "Releasing";
        case "NOT_YET_RELEASED":
          return "Not Yet Released";
        case "CANCELLED":
          return "Cancelled";
        case "HIATUS":
          return "Hiatus";
        case "NONE":
          return "None";
        default:
          return "N/A";
      }
    }
    formatFuzzyDate(date) {
      const formattedMonth = date.month != null && date.month < 10 ? `0${date.month}` : date.month ?? "??";
      const formattedDay = date.day != null && date.day < 10 ? `0${date.day}` : date.day ?? "??";
      return `${date.year ?? "??"}-${formattedMonth}-${formattedDay}`;
    }
    reverseFormatFuzzyDate(dateString) {
      if (dateString == null) {
        return null;
      }
      const [year, month, day] = dateString.split("-").map((part) => part === "??" ? void 0 : parseInt(part));
      return {
        year,
        month,
        day
      };
    }
    // formatAppleUnixTime(time: number): string {
    //     const date = new Date(time * 1000)
    //     const year = date.getUTCFullYear()
    //     const month = (date.getUTCMonth() + 1).toString().padStart(2, '0')
    //     const day = date.getUTCDate().toString().padStart(2, '0')
    //     return `${year}-${month}-${day}`
    // }
  };
  return __toCommonJS(Anilist_exports);
})();
this.Sources = _Sources; if (typeof exports === 'object' && typeof module !== 'undefined') {module.exports.Sources = this.Sources;}
